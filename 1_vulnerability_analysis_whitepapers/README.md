# 1_vulnerability_analysis_whitepapers

## Intro


퍼징을 위한 어택 벡터 선정을 위해 크롬 원데이를 재현하고 루트커즈 분석을 진행했다. 우리가 분석[^id1] 혹은 이미 분석이 되어 있는 글을 번역한 보고서를 공유한다. 번역과 함께 원데이를 재현한 후 직접 루트커즈 분석을 했음을 미리 알린다.

또한 개인 사정에 따라 공개하지 않는 보고서가 있음에 미리 양해를 구한다.

[^id1]: 인터넷에 분석 글이 공개되어 있지 않은 경우, 소스코드 오디팅을 통해 직접 분석을 진행함. 


## Contents

- CVE-2018-6036[^id2]
  - [crbug](https://bugs.chromium.org/p/chromium/issues/detail?id=789952)
  - wasm의 custom 섹션을 해석하는 `DecodeCustomSections`함수에서 payload의 길이 검증을 하지 않아 `integer underflow` 취약점이 발생하여 `Out-Of-Bound Read`가 발생할 수 있음
  
[^id2]: 손현지가 분석 진행

- [CVE-2018-6092](./../2_fuzzer_development/watTF/README.md#11-배경이-된-취약점-cve-2018-6092)[^id2] 
  - [crbug](https://bugs.chromium.org/p/chromium/issues/detail?id=819869&q=819869&can=2)
  - 32bit 플랫폼에서 `integer overflow`를 이용하여 로컬 함수의 수를 검증하는 루틴을 건너뛸 수 있기 때문에 많은 수의 로컬함수가 할당(insert)되어 `memory corruption`이 발생할 수 있음

- [CVE-2020-6449](./cve-2020-6449/README.md)[^id3] 
  - [crbug](https://bugs.chromium.org/p/chromium/issues/detail?id=1059686)
  - `BreakConnections`함수가 호출되고 frame을 닫아(`BaseAudioContext`를 파괴하여) `ClearHandlersToBeDeleted` 함수가 호출되면, `active_source_handlers_`가 지워지게 되는데, 이때 이것과 연관되어 있는 `finished_source_handlers_`는 동시에 지워지지 않고 `BreakConnections` 함수에서 사용되어 `UAF`가 발생할 수 있음
  - [원글1](https://securitylab.github.com/advisories/GHSL-2020-040-chrome/)과 [원글2](https://securitylab.github.com/research/CVE-2020-6449-exploit-chrome-uaf/)[^secret] 번역 진행 

[^id3]: 손현지가 번역 진행
[^secret]: 번역한 내용 비공개

- [CVE-2020-6551](./../3_codeql/Designing_CodeQL_queries.md#cve-2020-6551)[^id2] 
  - [crbug](https://bugs.chromium.org/p/chromium/issues/detail?id=1107815&q=CVE-2020-6551&can=1)
  - `XRSystem::FocusedFrameChanged`함수의 반복문 안에서 이터레이터를 얻어와 처리하는 도중, JS 콜백이 호출되어 맵이 재할당되기 때문에 댕글링 포인터가 된 이터레이터를 사용하면 `UAF`가 발생할 수 있음

- CVE-2020-6576[^id4]
  - [crbug](https://bugs.chromium.org/p/chromium/issues/detail?id=1111737)
  - 텍스트 렌더러 기능을 하는 `DrawTextInternal` 함수에서 free된 PaintCanvas 포인터가 재사용하는 것으로 인해 `UAF` 취약점이 발생할 수 있음

[^id4]: 이주협이 분석 진행

- [CVE-2020-15999](./cve-2020-15999/)[^id5]
  - [crbug](https://bugs.chromium.org/p/chromium/issues/detail?id=1139963&q=CVE-2020-15999&can=1)
  - FreeType에서 4바이트의 PNG width, height 값을 2바이트로 저장하기 때문에 더 적은 크기의 비트맵 chunk가 할당되고, 그 곳에 비트맵 데이터를 입력받으면 `heap overflow` 취약점이 발생할 수 있음

[^id5]: 홍택균이 분석 진행

- [CVE-2020-16002](./cve-2021-16002)[^id6]
  - [crbug](https://bugs.chromium.org/p/chromium/issues/detail?id=1137630&q=label%3Asecurity%20component%3AInternals%3EPlugins%3EPDF&can=1&colspec=ID%20Pri%20Type%20Component%20Status%20Summary%20Owner%20Target%20M%20Reporter%20Modified%20Opened%20CVE%20Reward)
  - CPWL_ListBox 에서 한 member의 destructor logic에서 다른 member에 대한 참조가 필요한데, destructor 호출 전에 해당 member가 delete되어 `UAF`취약점이 발생할 수 있음

[^id6]: 심준용이 분석 진행

- [CVE-2021-30519](./cve-2021-30519)[^id7]
  - [crbug](https://bugs.chromium.org/p/chromium/issues/detail?id=1194058&q=label%3ACVE-2021-30519&can=1)
  - Payments API에서 관련 객체가 삭제되었음에도 불구하고 삭제되지 않은 `WebContentsModalDialogManagerDelegate`에 엑세스함으로써 `UAF` 취약점이 발생할 수 있음
  
[^id7]: 이윤희가 분석 진행

